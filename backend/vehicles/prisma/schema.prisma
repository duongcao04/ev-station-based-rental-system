generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("VEHICLES_DATABASE_URL")
}

model SpecificationType {
  id             String             @id @default(uuid())
  label          String
  icon           String?
  description    String?
  specifications CarSpecification[]
}

model Category {
  id           String  @id @default(uuid())
  displayName  String
  description  String
  thumbnailUrl String?
  cars         Car[]   @relation("CarToCategory")
}

model Brand {
  id           String  @id @default(uuid())
  displayName  String
  description  String
  thumbnailUrl String?
  cars         Car[]
}

model CarSpecification {
  id                  String            @id @default(uuid())
  value               String
  carId               String
  specificationTypeId String
  car                 Car               @relation(fields: [carId], references: [id])
  specificationType   SpecificationType @relation(fields: [specificationTypeId], references: [id])

  @@unique([carId, specificationTypeId])
}

model Car {
  id              String             @id @default(uuid())
  regularPrice    Decimal            @db.Decimal(10, 2)
  salePrice       Decimal?           @db.Decimal(10, 2)
  depositPrice    Decimal?           @db.Decimal(10, 2)
  quantity        Int?
  isInStock       Boolean
  description     String?
  thumbnailUrl    String
  brandId         String?
  displayName     String
  sku             String
  slug            String
  status          CarStatus          @default(available)
  seatingCapacity Int                @default(4)
  brand           Brand?             @relation(fields: [brandId], references: [id])
  featuredImages  CarImage[]
  specifications  CarSpecification[]
  categories      Category[]         @relation("CarToCategory")
}

enum CarStatus {
  available
  rented
  maintenance
}

model CarImage {
  id    String @id @default(uuid())
  url   String
  sort  Int?
  carId String
  car   Car    @relation(fields: [carId], references: [id])

  @@index([carId, sort])
}
